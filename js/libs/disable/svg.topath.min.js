// svg.topath.js 0.3 - Copyright (c) 2014 Wout Fierens - Licensed under the MIT license
;(function(){function e(e){for(var t in e)if(!/fill|stroke|opacity/.test(t))delete e[t];return e}SVG.extend(SVG.Shape,{toPath:function(t){var n,r,i,s,o,u,a=this.trans,f=this.bbox(),l=0,c=0;switch(this.type){case"rect":n=this.attr("width");r=this.attr("height");i=this.attr("rx");s=this.attr("ry");if(i<0)i=0;if(s<0)s=0;i=i||s;s=s||i;if(i>n/2)i=n/2;if(s>r/2)s=r/2;if(i&&s){o=["M"+i+" "+c,"H"+(n-i),"A"+i+" "+s+" 0 0 1 "+n+" "+s,"V"+(r-s),"A"+i+" "+s+" 0 0 1 "+(n-i)+" "+r,"H"+i,"A"+i+" "+s+" 0 0 1 "+l+" "+(r-s),"V"+s,"A"+i+" "+s+" 0 0 1 "+i+" "+c,"z"]}else{o=["M"+l+" "+c,"H"+n,"V"+r,"H"+l,"V"+c,"z"]}l=this.attr("x");c=this.attr("y");break;case"circle":case"ellipse":i=this.type=="ellipse"?this.attr("rx"):this.attr("r");s=this.type=="ellipse"?this.attr("ry"):this.attr("r");o=["M"+i+" "+c,"A"+i+" "+s+" 0 0 1 "+i*2+" "+s,"A"+i+" "+s+" 0 0 1 "+i+" "+s*2,"A"+i+" "+s+" 0 0 1 "+l+" "+s,"A"+i+" "+s+" 0 0 1 "+i+" "+c,"z"];l=this.attr("cx")-i;c=this.attr("cy")-s;break;case"polygon":case"polyline":this.move(0,0);o=[];for(var h=0;h<this.array.value.length;h++)o.push((h==0?"M":"L")+this.array.value[h][0]+" "+this.array.value[h][1]);if(this.type=="polygon")o.push("Z");this.move(f.x,f.y);l=f.x;c=f.y;break;case"line":this.move(0,0);o=["M"+this.attr("x1")+" "+this.attr("y1"),"L"+this.attr("x2")+" "+this.attr("y2")];this.move(f.x,f.y);l=f.x;c=f.y;break;case"path":u=this.clone();u.unbiased=true;u.plot(this.attr("d"));l=f.x;c=f.y;break}if(Array.isArray(o)){u=this.parent.path(o.join(""),true).move(l+a.x,c+a.y).attr(e(this.attr()));this.after(u)}if(u){u.data("topath-type",this.type).data("topath-id",this.attr("id"));if(t===true)this.remove();else u.original=this}return u}})}).call(this);